<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>게시글 상세</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        .container {
            max-width: 800px;
            margin-top: 30px;
        }
        .post-image {
            max-width: 100%;
            height: auto;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .comment-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        .comment-user {
            font-weight: bold;
            color: #007bff;
        }
        .button-group {
            display: flex;
            justify-content: space-between;
        }
        .delete-btn {
            color: red;
            cursor: pointer;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="card shadow-sm">
        <div class="card-body">
            <h2 class="card-title">{{board.title}}</h2>
            <p class="text-muted">
                <strong>작성자:</strong> {{board.userId}} &nbsp; | &nbsp;
                <strong>작성일:</strong> <span class="createdDate">{{#board.createdDate}}{{board.createdDate}}{{/board.createdDate}}{{^board.createdDate}}N/A{{/board.createdDate}}</span> &nbsp; | &nbsp;
                <strong>조회수:</strong> {{board.viewCount}}
            </p>

            <!-- 이미지 표시 -->
            {{#board.imageUrl}}
                <img src="{{board.imageUrl}}" alt="게시글 이미지" class="post-image">
            {{/board.imageUrl}}

            <!-- 게시글 내용 -->
            <p class="card-text">{{{board.content}}}</p>
        </div>
    </div>

    <hr>

    <!-- 댓글 목록 -->
    <h3>댓글</h3>
    <div class="list-group">
        {{#comments}}
            <div class="comment-box">
                <p><span class="comment-user">{{userId}}</span>: {{content}}</p>
                <form action="/comments/{{id}}/delete" method="post" style="display: inline;">
                    <input type="hidden" name="boardId" value="{{board.id}}">
                    <button type="submit" class="btn btn-sm btn-outline-danger">삭제</button>
                </form>
            </div>
        {{/comments}}
        {{^comments}}
            <p class="text-muted">등록된 댓글이 없습니다.</p>
        {{/comments}}
    </div>

    <!-- 댓글 작성 -->
    <h4 class="mt-4">댓글 작성</h4>
    <form action="/comments" method="post">
        <input type="hidden" name="boardId" value="{{board.id}}">
        <div class="mb-3">
            <textarea name="content" class="form-control" rows="3" placeholder="댓글을 입력하세요" required></textarea>
        </div>
        <button type="submit" class="btn btn-primary">댓글 작성</button>
    </form>

    <hr>

    <!-- 버튼 그룹 -->
    <div class="button-group">
        <a href="/board/" class="btn btn-secondary">목록으로</a>
        <div>
            <a href="/board/edit/{{board.id}}" class="btn btn-warning">수정</a>
            <form action="/board/delete/{{board.id}}" method="post" style="display: inline;">
                <button type="submit" class="btn btn-danger" onclick="return confirm('정말 삭제하시겠습니까?');">삭제</button>
            </form>
        </div>
    </div>
</div>

<!-- 날짜 포맷 변경 스크립트 -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const createdDateElements = document.querySelectorAll('.createdDate');

        createdDateElements.forEach(function (element) {
            const dateText = element.innerText.trim();
            if (dateText !== 'N/A') {
                const dateObj = new Date(dateText);
                const formattedDate = dateObj.toISOString().split('T')[0]; // "YYYY-MM-DD" 형식으로 포맷
                element.innerText = formattedDate;
            }
        });
    });
</script>

<!-- 부트스트랩 JS (필요할 경우) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
